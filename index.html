<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Auraa</title>
  <link rel="icon" type="image/x-icon" href="icon.png" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap');
    body {
      margin: 0; padding: 0;
      background: linear-gradient(135deg, #2a003f, #000000);
      color: #fff;
      font-family: 'Poppins', sans-serif;
      height: 100vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    #tabBar {
      display: flex;
      background: rgba(35,0,55,0.9);
      box-shadow: 0 0 8px rgba(157,78,221,0.9);
      padding: 0 10px;
      user-select: none;
      height: 40px;
      align-items: center;
      gap: 5px;
    }
    #tabBar button.tab {
      background: transparent;
      border: none;
      color: white;
      padding: 5px 12px;
      border-radius: 5px 5px 0 0;
      cursor: pointer;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: background 0.3s;
      position: relative;
      font-size: 1rem;
    }
    #tabBar button.tab.active {
      background: #7b2cbf;
      box-shadow: 0 -2px 5px #9d4edd;
    }
    #tabBar button.tab .closeBtn {
      font-size: 0.8rem;
      margin-left: 6px;
      color: #ccc;
      cursor: pointer;
      user-select: none;
    }
    #tabBar button.tab:hover .closeBtn {
      color: white;
    }
    #tabBar button#addTabBtn {
      font-size: 1.4rem;
      font-weight: bold;
      background: transparent;
      border: none;
      color: #9d4edd;
      cursor: pointer;
      user-select: none;
      margin-left: auto;
    }
    #iframeContainer {
      flex-grow: 1;
      position: relative;
    }
    iframe.tabIframe {
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      border: none;
      background: white;
      display: none;
      border-radius: 0 0 10px 10px;
      box-shadow: inset 0 0 20px #7b2cbf88;
    }
    iframe.tabIframe.active {
      display: block;
    }
    #searchContainer {
      padding: 10px;
      background: rgba(50, 0, 80, 0.9);
      display: flex;
      gap: 10px;
      align-items: center;
      color: white;
    }
    #urlInput {
      flex-grow: 1;
      padding: 8px 12px;
      border-radius: 20px;
      border: none;
      font-size: 1rem;
      outline: none;
      background: #2a003f;
      color: white;
      box-shadow: 0 0 8px #9d4edd88;
    }
    #goBtn {
      padding: 8px 20px;
      background: #7b2cbf;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.3s;
    }
    #goBtn:hover {
      background: #9d4edd;
    }
    .sidebar {
      position: fixed;
      left: 10px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(35, 0, 55, 0.9);
      padding: 10px;
      width: 60px;
      border-radius: 10px;
      box-shadow: 0 0 8px rgba(157, 78, 221, 0.9);
      display: flex;
      flex-direction: column;
      align-items: center;
      z-index: 20;
    }
    .sidebar button {
      background: transparent;
      border: none;
      font-size: 2rem;
      color: #fff;
      margin: 10px 0;
      cursor: pointer;
      transition: 0.3s;
    }
    .sidebar button:hover {
      color: #e0aaff;
    }
    .sidebar-info {
      margin-top: 10px;
      font-size: 1rem;
      color: white;
      text-shadow: 0 0 5px #c77dff;
    }
    .auraa-title {
      font-weight: 700;
      font-size: 1.1rem;
      user-select: none;
      display: flex;
      align-items: center;
      gap: 2px;
      white-space: nowrap;
    }
    .auraa-title .dot {
      color: #9d4edd;
      text-shadow: 0 0 10px #9d4edd, 0 0 20px #7b2cbf, 0 0 30px #ffffff;
      font-size: 1.3rem;
      line-height: 1;
    }
  </style>
</head>
<body>
  <div class="sidebar">
    <button id="homeBtn" title="Home"><i class="bi bi-house"></i></button>
    <button id="gamesBtn" title="Games"><i class="bi bi-joystick"></i></button>
    <button id="moviesBtn" title="Movies"><i class="bi bi-film"></i></button>
    <button id="chatBtn" title="Chat"><i class="bi bi-chat-dots"></i></button>
    <button id="creditsBtn" title="Credits"><i class="bi bi-info-circle"></i></button>
    <button id="settingsBtn" title="Settings"><i class="bi bi-gear"></i></button>
    <button id="weatherBtn" title="Weather"><i class="bi bi-cloud-sun"></i></button>
    <div class="sidebar-info">
      <span id="battery">⚡</span>
      <span id="time">⌚</span>
    </div>
  </div>

  <div id="tabBar">
    <button id="addTabBtn" title="New Tab">＋</button>
  </div>
  <div id="searchContainer">
    <input type="text" id="urlInput" placeholder="Enter URL or search term..." autocomplete="off" />
    <button id="goBtn">Go</button>
  </div>
  <div id="iframeContainer"></div>

  <script src="/active/uv/uv.bundle.js" defer></script>
  <script src="/active/uv/uv.config.js" defer></script>
  <script src="/assets/js/register.js" defer></script>
  <script src="/assets/js/index.js" defer></script>

  <script>
    const tabBar = document.getElementById('tabBar');
    const addTabBtn = document.getElementById('addTabBtn');
    const iframeContainer = document.getElementById('iframeContainer');
    const urlInput = document.getElementById('urlInput');
    const goBtn = document.getElementById('goBtn');

    const homeBtn = document.getElementById('homeBtn');
    const gamesBtn = document.getElementById('gamesBtn');
    const moviesBtn = document.getElementById('moviesBtn');
    const chatBtn = document.getElementById('chatBtn');
    const creditsBtn = document.getElementById('creditsBtn');
    const settingsBtn = document.getElementById('settingsBtn');
    const weatherBtn = document.getElementById('weatherBtn');

    let tabs = [];
    let activeTabId = null;
    let tabCounter = 0;

    function generateSearchUrl(query) {
      try {
        const url = new URL(query);
        return url.toString();
      } catch {
        try {
          const url = new URL(`https://${query}`);
          if (url.hostname.includes('.')) return url.toString();
        } catch {}
      }
      return `https://startpage.com/search?q=${encodeURIComponent(query)}&source=web`;
    }

    function createTab(url, isHome = false) {
      tabCounter++;
      const id = 'tab-' + tabCounter;
      const encodedUrl = __uv$config.prefix + __uv$config.encodeUrl(url);

      const tabButton = document.createElement('button');
      tabButton.className = 'tab';
      tabButton.id = id;
      tabButton.title = url;

      if (isHome) {
        const auraaTitle = document.createElement('span');
        auraaTitle.className = 'auraa-title';
        auraaTitle.innerHTML = 'Auraa<span class="dot">.</span>';
        tabButton.appendChild(auraaTitle);
      } else {
        tabButton.textContent = url.length > 30 ? url.slice(0, 27) + '...' : url;
      }

      const closeBtn = document.createElement('span');
      closeBtn.className = 'closeBtn';
      closeBtn.innerHTML = '&times;';
      tabButton.appendChild(closeBtn);

      tabBar.insertBefore(tabButton, addTabBtn);

      const iframe = document.createElement('iframe');
      iframe.className = 'tabIframe';
      iframe.id = 'iframe-' + id;
      iframe.src = encodedUrl;

      iframeContainer.appendChild(iframe);

      tabs.push({id, url, tabButton, iframe, isHome});

      tabButton.addEventListener('click', (e) => {
        if (e.target === closeBtn) {
          closeTab(id);
        } else {
          activateTab(id);
        }
      });

      activateTab(id);
    }

    function activateTab(id) {
      if (activeTabId === id) return;
      tabs.forEach(tab => {
        if (tab.id === id) {
          tab.tabButton.classList.add('active');
          tab.iframe.classList.add('active');
          urlInput.value = tab.url;
          activeTabId = id;
        } else {
          tab.tabButton.classList.remove('active');
          tab.iframe.classList.remove('active');
        }
      });
    }

    function closeTab(id) {
      const index = tabs.findIndex(tab => tab.id === id);
      if (index === -1) return;

      const tab = tabs[index];
      tab.tabButton.remove();
      tab.iframe.remove();

      tabs.splice(index, 1);

      if (tabs.length > 0) {
        const newActiveIndex = index > 0 ? index - 1 : 0;
        activateTab(tabs[newActiveIndex].id);
      } else {
        activeTabId = null;
        urlInput.value = '';
      }
    }

    addTabBtn.addEventListener('click', () => {
      const defaultUrl = 'https://auraa.vercel.app/';
      createTab(defaultUrl);
    });

    goBtn.addEventListener('click', () => {
      const query = urlInput.value.trim();
      if (!query) return;
      if (!activeTabId) {
        createTab(generateSearchUrl(query));
      } else {
        const tab = tabs.find(t => t.id === activeTabId);
        if (!tab) return;
        tab.url = generateSearchUrl(query);
        if (tab.isHome) {
          tab.tabButton.textContent = '';
          const auraaTitle = document.createElement('span');
          auraaTitle.className = 'auraa-title';
          auraaTitle.innerHTML = 'Auraa<span class="dot">.</span>';
          tab.tabButton.appendChild(auraaTitle);
          const closeBtn = document.createElement('span');
          closeBtn.className = 'closeBtn';
          closeBtn.innerHTML = '&times;';
          tab.tabButton.appendChild(closeBtn);
        } else {
          tab.tabButton.textContent = query.length > 30 ? query.slice(0, 27) + '...' : query;
          const closeBtn = document.createElement('span');
          closeBtn.className = 'closeBtn';
          closeBtn.innerHTML = '&times;';
          tab.tabButton.appendChild(closeBtn);
        }
        tab.iframe.src = __uv$config.prefix + __uv$config.encodeUrl(tab.url);
      }
    });

    urlInput.addEventListener('keydown', e => {
      if (e.key === 'Enter') {
        e.preventDefault();
        goBtn.click();
      }
    });

    function openSidebarTab(url, isHome = false) {
      createTab(url, isHome);
    }

    homeBtn.addEventListener('click', () => openSidebarTab('https://auraa.vercel.app/index.html', true));
    gamesBtn.addEventListener('click', () => openSidebarTab('https://auraa.vercel.app/games.html'));
    moviesBtn.addEventListener('click', () => openSidebarTab('https://auraa.vercel.app/movies.html'));
    chatBtn.addEventListener('click', () => openSidebarTab('https://auraa.vercel.app/tidechat.html'));
    creditsBtn.addEventListener('click', () => openSidebarTab('https://auraa.vercel.app/credits.html'));
    settingsBtn.addEventListener('click', () => openSidebarTab('https://auraa.vercel.app/settings.html'));
    weatherBtn.addEventListener('click', () => openSidebarTab('https://auraa.vercel.app/weather.html'));

    window.onload = () => {
      if (typeof __uv$config === "undefined") {
        alert("Ultraviolet proxy not loaded.");
        return;
      }
      createTab('https://auraa.vercel.app/', true);
    };

    if (navigator.getBattery) {
      navigator.getBattery().then(battery => {
        function updateBattery() {
          document.getElementById("battery").textContent = `${Math.round(battery.level * 100)}% ⚡`;
        }
        updateBattery();
        battery.addEventListener("levelchange", updateBattery);
      });
    } else {
      document.getElementById("battery").textContent = "Battery: N/A";
    }

    function updateTime() {
      const now = new Date();
      document.getElementById("time").textContent = now.toLocaleTimeString();
    }
    setInterval(updateTime, 1000);
    updateTime();
  </script>
</body>
</html>
