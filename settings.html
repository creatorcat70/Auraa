<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Auraa Settings</title>
<link rel="icon" type="image/png" href="icon.png" id="dynamicFavicon" />
<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap');
  body {
    margin: 0;
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(135deg, #2a003f, #000000);
    color: #fff;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    padding: 2rem;
    user-select: none;
  }
  h1 {
    font-size: 3rem;
    text-align: center;
    margin-bottom: 2rem;
    font-weight: 700;
    background: linear-gradient(135deg, #9d4edd, #7b2cbf);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  label {
    display: block;
    margin: 1rem 0 0.5rem 0;
    font-weight: 600;
  }
  select, input[type="checkbox"], input[type="number"] {
    width: 100%;
    max-width: 360px;
    padding: 12px 15px;
    font-size: 1.1rem;
    border-radius: 25px;
    border: none;
    background: rgba(50, 0, 80, 0.9);
    color: white;
    box-shadow: 0 0 8px rgba(157, 78, 221, 0.4);
    cursor: pointer;
    outline: none;
    transition: background 0.3s ease, box-shadow 0.3s ease;
    box-sizing: border-box;
  }
  select:hover, select:focus, input[type="number"]:hover, input[type="number"]:focus {
    background: rgba(70, 0, 100, 0.95);
    box-shadow: 0 0 12px rgba(233, 145, 255, 0.9);
  }
  input[type="checkbox"] {
    width: auto;
    margin-right: 10px;
    cursor: pointer;
    box-shadow: none;
    background: none;
    vertical-align: middle;
  }
  button {
    margin-top: 3rem;
    padding: 14px 40px;
    font-size: 1.3rem;
    font-weight: 700;
    border: none;
    border-radius: 25px;
    background: #7b2cbf;
    color: white;
    cursor: pointer;
    box-shadow: 0 0 15px #9d4edd;
    align-self: center;
    transition: background 0.3s ease;
  }
  button:hover {
    background: #9d4edd;
  }
  .footer {
    margin-top: auto;
    text-align: center;
    font-size: 0.9rem;
    color: rgba(255, 255, 255, 0.7);
    text-shadow: 0 0 5px #c77dff;
  }
  .section {
    max-width: 400px;
    margin: 0 auto 1.5rem auto;
  }
  .favicon-preview {
    display: inline-block;
    width: 40px;
    height: 40px;
    vertical-align: middle;
    margin-left: 10px;
    border-radius: 6px;
    border: 1.5px solid #9d4edd;
  }
  #snowCanvas {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none;
    z-index: 1;
  }
</style>
</head>
<body>

<canvas id="snowCanvas"></canvas>

<h1 id="pageTitle">Auraa Settings</h1>

<div class="section">
  <label for="faviconSelect">Tab Icon</label>
  <select id="faviconSelect" aria-label="Select Tab Icon">
    <option value="icon.png" selected>Default Auraa Icon</option>
    <option value="favicon_education1.ico">Education Icon 1</option>
    <option value="favicon_education2.ico">Education Icon 2</option>
    <option value="favicon_education3.ico">Education Icon 3</option>
  </select>
  <img id="faviconPreview" class="favicon-preview" src="icon.png" alt="Icon Preview" />
</div>

<div class="section">
  <label for="titleSelect">Tab Title</label>
  <select id="titleSelect" aria-label="Select Tab Title">
    <option value="Auraa" selected>Auraa</option>
    <option value="Education Portal">Education Portal</option>
    <option value="Student Dashboard">Student Dashboard</option>
    <option value="Learning Hub">Learning Hub</option>
  </select>
</div>

<div class="section">
  <label><input type="checkbox" id="confirmBeforeClose" /> Confirm before closing tab</label>
</div>

<div class="section">
  <label><input type="checkbox" id="particlesToggle" /> Enable Particle Snowfall</label>
</div>

<div class="section">
  <label for="particleCount">Particle Count (0-300)</label>
  <input type="number" id="particleCount" min="0" max="300" step="1" />
</div>

<button id="saveSettings">Save Settings</button>

<div class="footer">Â© 2025 Auraa | Made by @thefakesydney</div>

<script>
  const faviconSelect = document.getElementById('faviconSelect');
  const faviconPreview = document.getElementById('faviconPreview');
  const titleSelect = document.getElementById('titleSelect');
  const confirmBeforeClose = document.getElementById('confirmBeforeClose');
  const particlesToggle = document.getElementById('particlesToggle');
  const particleCountInput = document.getElementById('particleCount');
  const saveBtn = document.getElementById('saveSettings');
  const faviconTag = document.getElementById('dynamicFavicon') || createFaviconTag();
  const pageTitle = document.getElementById('pageTitle');
  const canvas = document.getElementById('snowCanvas');
  const ctx = canvas.getContext('2d');

  let flakes = [];
  let width, height;
  let animationId;

  function createFaviconTag() {
    const link = document.createElement('link');
    link.rel = 'icon';
    link.type = 'image/png';
    document.head.appendChild(link);
    return link;
  }

  function loadSettings() {
    const icon = localStorage.getItem('auraaFavicon') || 'icon.png';
    const title = localStorage.getItem('auraaTitle') || 'Auraa';
    const confirmClose = localStorage.getItem('auraaConfirmBeforeClose') === 'true';
    const particlesEnabled = localStorage.getItem('auraaParticlesEnabled') === 'true';
    const particleCountStored = parseInt(localStorage.getItem('auraaParticleCount'), 10);

    faviconSelect.value = icon;
    titleSelect.value = title;
    confirmBeforeClose.checked = confirmClose;
    particlesToggle.checked = particlesEnabled;
    particleCountInput.value = Number.isInteger(particleCountStored) ? particleCountStored : 100;

    updateFavicon(icon);
    updateFaviconPreview(icon);
    updateTitle(title);

    if (particlesEnabled) {
      startParticles();
    } else {
      stopParticles();
    }
  }

  function updateFavicon(icon) {
    faviconTag.href = icon;
  }

  function updateFaviconPreview(icon) {
    faviconPreview.src = icon;
  }

  function updateTitle(title) {
    document.title = title;
    pageTitle.textContent = `${title} Settings`;
    pageTitle.style.background = 'linear-gradient(135deg, #9d4edd, #7b2cbf)';
    pageTitle.style.webkitBackgroundClip = 'text';
    pageTitle.style.webkitTextFillColor = 'transparent';
  }

  function resizeCanvas() {
    width = canvas.width = window.innerWidth;
    height = canvas.height = window.innerHeight;
  }

  function createFlakes(count) {
    flakes = [];
    for (let i = 0; i < count; i++) {
      flakes.push({
        x: Math.random() * width,
        y: Math.random() * height,
        radius: Math.random() * 1.5 + 0.5,
        speedY: Math.random() * 0.5 + 0.2,
        speedX: (Math.random() - 0.5) * 0.2
      });
    }
  }

  function drawParticles() {
    ctx.clearRect(0, 0, width, height);
    ctx.fillStyle = 'rgba(255,255,255,0.8)';
    ctx.beginPath();
    flakes.forEach(flake => {
      ctx.moveTo(flake.x, flake.y);
      ctx.arc(flake.x, flake.y, flake.radius, 0, Math.PI * 2);
    });
    ctx.fill();
    updateParticles();
    animationId = requestAnimationFrame(drawParticles);
  }

  function updateParticles() {
    flakes.forEach(flake => {
      flake.y += flake.speedY;
      flake.x += flake.speedX;
      if (flake.y > height) {
        flake.y = 0;
        flake.x = Math.random() * width;
      }
      if (flake.x > width) flake.x = 0;
      if (flake.x < 0) flake.x = width;
    });
  }

  function startParticles() {
    resizeCanvas();
    createFlakes(parseInt(particleCountInput.value, 10) || 100);
    if (!animationId) {
      drawParticles();
    }
  }

  function stopParticles() {
    if (animationId) {
      cancelAnimationFrame(animationId);
      animationId = null;
      ctx.clearRect(0, 0, width, height);
    }
  }

  faviconSelect.addEventListener('change', () => {
    updateFaviconPreview(faviconSelect.value);
  });

  particlesToggle.addEventListener('change', () => {
    if (particlesToggle.checked) {
      startParticles();
    } else {
      stopParticles();
    }
  });

  saveBtn.addEventListener('click', () => {
    const selectedIcon = faviconSelect.value;
    const selectedTitle = titleSelect.value;
    const confirmCloseChecked = confirmBeforeClose.checked;
    const particlesEnabled = particlesToggle.checked;
    let particleCount = parseInt(particleCountInput.value, 10);
    if (!Number.isInteger(particleCount) || particleCount < 0) particleCount = 100;
    if (particleCount > 300) particleCount = 300;

    localStorage.setItem('auraaFavicon', selectedIcon);
    localStorage.setItem('auraaTitle', selectedTitle);
    localStorage.setItem('auraaConfirmBeforeClose', confirmCloseChecked);
    localStorage.setItem('auraaParticlesEnabled', particlesEnabled);
    localStorage.setItem('auraaParticleCount', particleCount);

    updateFavicon(selectedIcon);
    updateTitle(selectedTitle);
    particleCountInput.value = particleCount;

    alert('Settings saved!');
  });

  window.addEventListener('beforeunload', (e) => {
    if (localStorage.getItem('auraaConfirmBeforeClose') === 'true') {
      e.preventDefault();
      e.returnValue = '';
    }
  });

  window.addEventListener('resize', () => {
    if (particlesToggle.checked) {
      resizeCanvas();
      createFlakes(parseInt(particleCountInput.value, 10) || 100);
    }
  });

  loadSettings();
</script>

</body>
</html>
